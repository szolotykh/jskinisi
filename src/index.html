<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Kinisi motor controller</title>
    <script src="./utils.js"></script>
    <script src="./chart_speed_controller.js"></script>
    <script src="./commands/kinisi_commands.js"></script>
    <script src="./commands/kinisi_client.js"></script>
    <script src="./gpio.js"></script>
    <script src="./main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="./main.css">
  </head>
  <body onload="main()">
    <h1>Kinisi motor controller</h1>
    <p>Use the form below to send commands to the motor controller:</p>
      <div>
        <button id="buttonConnectController">Connect</button>
        <button id="buttonDisconectController" disabled="true" >Diconnect</button>
        <p id="status"></p>
      </div>

      <div class="w3-bar w3-black">
        <button class="w3-bar-item w3-button" onclick="openTab('tabMotor')">Motor</button>
        <button class="w3-bar-item w3-button" onclick="openTab('tabController')">Controller</button>
        <button class="w3-bar-item w3-button" onclick="openTab('tabPlatform')">Platform</button>
        <button class="w3-bar-item w3-button" onclick="openTab('tabGPIO')">GPIO</button>
      </div>

    <!-- Motor -->
      <div id="tabMotor" class="controllerTab w3-panel">
        <h2>Motor</h2>
        <label for="motorIndex">Motor Index:</label>
        <select id="motorIndex">
          <option value="0">Motor 0</option>
          <option value="1">Motor 1</option>
          <option value="2">Motor 2</option>
          <option value="3">Motor 3</option>
        </select>
        <br>
        <label for="motorIsReversed">Is Reverse</label>
        <input type="checkbox" id="motorIsReversed">
        <br>
        <label for="motorDirection">Direction:</label>
        <input type="range" min="0" max="1" value="0" id="motorDirection">
        <br>
        <label for="motorSpeed">Speed:</label>
        <input type="range" min="0" max="840" value="420" id="motorSpeed">
        <br>
        <button id = "buttonSetMotorSpeed">Set motor Speed</button><br>
        <button id = "buttonStopMotor">Stop motor</button><br>
        <button id = "buttonBrakeMotor">Brake motor</button><br>
        <hr>
        <h2>Encoder</h2>
        <div>
          <label for="encoderIndex">Motor Index:</label>
          <select id="encoderIndex">
            <option value="0">Encoder 0</option>
            <option value="1">Encoder 1</option>
            <option value="2">Encoder 2</option>
            <option value="3">Encoder 3</option>
          </select><br>
          <button id = "buttonGetEncoderValue">Get Encoder Value</button>
          <div id="encoderValue"></div>
        </div>
      </div>

      <!-- Velocity Controller -->
      <div id="tabController" class="controllerTab w3-panel">
        <h2>Motor Controller</h2>
        <label for="motorControllerIndex">Motor Index:</label>
        <select id="motorControllerIndex">
          <option value="0">Motor 0</option>
          <option value="1">Motor 1</option>
          <option value="2">Motor 2</option>
          <option value="3">Motor 3</option>
        </select>
        <br>
        <input type="number" value = "0.4" id="motorControllerKP">
        <input type="number" value = "0.05" id="motorControllerKI">
        <input type="number" value = "0.1" id="motorControllerKD">
        <button id = "buttonSetMotorController">SetMotorController</button><br>
        <label for="motorTargetDirection">Direction:</label>
        <input type="range" min="0" max="1" value="1" id="motorTargetDirection">
        <br>
        <label for="motorTargetSpeed">Speed:</label>
        <input type="range" min="0" max="100" value="50" id="motorTargetSpeed"><br>
        <button id = "buttonSetMotorTargetVelocity">SetMotorTargetVelocity</button><br><br>
        <button id = "buttonDelMotorController">DelMotorController</button>
        <canvas id="chartSpeedController" style="width:100%;max-width:800px"></canvas>
      </div>
      <!-- Platform -->
      <div id="tabPlatform" class="controllerTab w3-panel">

        <label for="platformSelector">Platform:</label>
        <select id="platformSelector">
          <option value="0">Mecanum Platform</option>
          <option value="1">Omni Platfrom</option>
        </select>

        <div id="mecanuPlatform">
          <h2>Mecanum Platform</h2>
          <div>
            Motor setup (is reversed):<br>
            <label for="mecanumPlatformIsReverse0">0</label>
            <input type="checkbox" id="mecanumPlatformIsReverse0">
            <label for="mecanumPlatformIsReverse1">1</label>
            <input type="checkbox" id="mecanumPlatformIsReverse1">
            <label for="mecanumPlatformIsReverse2">2</label>
            <input type="checkbox" id="mecanumPlatformIsReverse2">
            <label for="mecanumPlatformIsReverse3">3</label>
            <input type="checkbox" id="mecanumPlatformIsReverse3">
          </div>
          <button id = "buttonInitializeMecanumPlatform">Initialize</button><br>
        </div>

        <div id="omniPlatform">
          <h2>Omni Platform</h2>
          <div>
            Motor setup (is reversed):<br>
            <label for="omniPlatformIsReverse0">0</label>
            <input type="checkbox" id="omniPlatformIsReverse0">
            <label for="omniPlatformIsReverse1">1</label>
            <input type="checkbox" id="omniPlatformIsReverse1">
            <label for="omniPlatformIsReverse2">2</label>
            <input type="checkbox" id="omniPlatformIsReverse2">
          </div>
          <button id = "buttonInitializeOmniPlatform">Initialize</button><br>
        </div>

        <div>
          <label for="platformVelocityX">X</label>
          <input type="range" min="-100" max="100" value="0" step="10" id="platformVelocityX"><br>
          <label for="platformVelocityY">Y</label>
          <input type="range" min="-100" max="100" value="0" step="10" id="platformVelocityY"><br>
          <label for="platformVelocityT">T</label>
          <input type="range" min="-100" max="100" value="0" step="10" id="platformVelocityT"><br>
          <button id = "buttonSetPlatformVelocity">SetPlatfromVelocity</button><br>
        </div>
      </div>
      <!-- GPIO -->
      <div id="tabGPIO" class="controllerTab w3-panel"></div>
  </body>
</html>
